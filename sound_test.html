<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ³å£°ãƒ†ã‚¹ãƒˆ - Hello World</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #222;
            color: white;
        }
        button {
            padding: 20px 40px;
            font-size: 18px;
            margin: 10px;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            background: #4CAF50;
            color: white;
        }
        button:hover {
            background: #45a049;
        }
        #status {
            margin: 20px 0;
            padding: 10px;
            background: #333;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>ğŸµ éŸ³å£°ãƒ†ã‚¹ãƒˆ - Hello World</h1>
    <div id="status">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: åˆæœŸåŒ–å¾…ã¡</div>
    
    <button id="testBtn">ğŸ”Š ãƒ†ã‚¹ãƒˆéŸ³ã‚’å†ç”Ÿ</button>
    <button id="beepBtn">ğŸ“¢ ãƒ“ãƒ¼ãƒ—éŸ³</button>
    <button id="chordBtn">ğŸµ å’ŒéŸ³</button>

    <script>
        // æœ€å°é™ã®AudioContext ãƒ†ã‚¹ãƒˆ
        let audioContext = null;
        let isReady = false;
        
        function updateStatus(message) {
            document.getElementById('status').textContent = 'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ' + message;
            console.log('ğŸµ', message);
        }
        
        async function initAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                updateStatus(`AudioContextä½œæˆæˆåŠŸ (çŠ¶æ…‹: ${audioContext.state})`);
                
                if (audioContext.state === 'suspended') {
                    await audioContext.resume();
                    updateStatus(`AudioContextå†é–‹å®Œäº† (çŠ¶æ…‹: ${audioContext.state})`);
                }
                
                isReady = true;
                playTestSound(); // åˆæœŸåŒ–å¾Œã™ãã«ãƒ†ã‚¹ãƒˆéŸ³
                
            } catch (error) {
                updateStatus(`AudioContextä½œæˆå¤±æ•—: ${error.message}`);
            }
        }
        
        function playTestSound() {
            if (!isReady || !audioContext) {
                updateStatus('AudioContextãŒæº–å‚™ã•ã‚Œã¦ã„ã¾ã›ã‚“');
                return;
            }
            
            try {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(440, audioContext.currentTime); // A4éŸ³
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.01);
                gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
                
                updateStatus('ãƒ†ã‚¹ãƒˆéŸ³å†ç”Ÿä¸­... (440Hz, 0.5ç§’)');
                
            } catch (error) {
                updateStatus(`éŸ³å£°å†ç”Ÿã‚¨ãƒ©ãƒ¼: ${error.message}`);
            }
        }
        
        function playBeep() {
            if (!isReady || !audioContext) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.type = 'square';
            
            gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + 0.1);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.1);
            
            updateStatus('ãƒ“ãƒ¼ãƒ—éŸ³å†ç”Ÿ (800Hz)');
        }
        
        function playChord() {
            if (!isReady || !audioContext) return;
            
            const frequencies = [261.63, 329.63, 392.00]; // C-E-G
            
            frequencies.forEach(freq => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + 1);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 1);
            });
            
            updateStatus('å’ŒéŸ³å†ç”Ÿ (C-E-G)');
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        document.getElementById('testBtn').addEventListener('click', playTestSound);
        document.getElementById('beepBtn').addEventListener('click', playBeep);
        document.getElementById('chordBtn').addEventListener('click', playChord);
        
        // æœ€åˆã®ã‚¯ãƒªãƒƒã‚¯ã§åˆæœŸåŒ–
        document.addEventListener('click', () => {
            if (!isReady) {
                initAudio();
            }
        }, { once: true });
        
        updateStatus('ç”»é¢ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ ã‚’é–‹å§‹ã—ã¦ãã ã•ã„');
    </script>
</body>
</html>