<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Epic Battle RPG - 爽快戦闘システム</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="game-container">
        <!-- ヘッダー -->
        <header id="game-header">
            <h1>⚔️ Epic Battle RPG</h1>
            <div id="game-stats">
                <span id="score">Score: 0</span>
                <span id="level">Level: 1</span>
                <span id="exp">EXP: 0/100</span>
            </div>
            <div id="save-controls">
                <button id="save-btn" class="save-btn">💾 セーブ</button>
                <button id="load-btn" class="save-btn">📂 ロード</button>
            </div>
            <div id="version-display">v0.50</div>
        </header>

        <!-- メインゲーム画面 -->
        <main id="game-main">
            <!-- 戦闘画面 -->
            <div id="battle-arena">
                <!-- プレイヤー側 -->
                <div id="player-side" class="battle-side">
                    <div id="player-character" class="character">
                        <div class="character-sprite">🛡️</div>
                        <div class="character-info">
                            <h3 id="player-name">勇者</h3>
                            <div class="hp-bar">
                                <div class="bar-label">HP</div>
                                <div class="bar-container">
                                    <div id="player-hp-bar" class="bar hp-bar-fill"></div>
                                    <span id="player-hp-text">100/100</span>
                                </div>
                            </div>
                            <div class="mp-bar">
                                <div class="bar-label">MP</div>
                                <div class="bar-container">
                                    <div id="player-mp-bar" class="bar mp-bar-fill"></div>
                                    <span id="player-mp-text">50/50</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VS表示 -->
                <div id="vs-indicator">
                    <div class="vs-text">VS</div>
                </div>

                <!-- 敵側 -->
                <div id="enemy-side" class="battle-side">
                    <div id="enemy-character" class="character">
                        <div class="character-sprite">👹</div>
                        <div class="character-info">
                            <h3 id="enemy-name">スライム</h3>
                            <div class="hp-bar">
                                <div class="bar-label">HP</div>
                                <div class="bar-container">
                                    <div id="enemy-hp-bar" class="bar hp-bar-fill"></div>
                                    <span id="enemy-hp-text">60/60</span>
                                </div>
                            </div>
                            <!-- 傷口状態表示エリア -->
                            <div id="wound-indicators" class="wound-display">
                                <div id="physical-wounds" class="wound-category">
                                    <span class="wound-label">物理傷:</span>
                                    <div class="wound-icons">
                                        <span id="slash-wounds" class="wound-indicator slash" title="斬撃傷">🩸</span>
                                        <span id="blunt-wounds" class="wound-indicator blunt" title="打撃傷">🟤</span>
                                        <span id="pierce-wounds" class="wound-indicator pierce" title="突き傷">🔴</span>
                                    </div>
                                </div>
                                <div id="magical-wounds" class="wound-category">
                                    <span class="wound-label">魔法傷:</span>
                                    <div class="wound-icons">
                                        <span id="fire-wounds" class="wound-indicator fire" title="炎傷">🔥</span>
                                        <span id="lightning-wounds" class="wound-indicator lightning" title="雷傷">⚡</span>
                                        <span id="holy-wounds" class="wound-indicator holy" title="聖傷">✨</span>
                                        <span id="ice-wounds" class="wound-indicator ice" title="氷傷">❄️</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ダメージ表示エリア -->
            <div id="damage-area"></div>

            <!-- エフェクト表示エリア -->
            <div id="effect-area"></div>

            <!-- 戦闘ログ -->
            <div id="battle-log">
                <div id="log-content">
                    <p>戦闘開始！勇敢な戦士よ、立ち上がれ！</p>
                </div>
            </div>

            <!-- コントロールパネル -->
            <div id="control-panel">
                <div id="action-buttons">
                    <button id="attack-btn" class="action-btn attack">
                        ⚔️ 攻撃
                    </button>
                    <button id="skill-btn" class="action-btn skill">
                        ✨ スキル
                    </button>
                    <button id="guard-btn" class="action-btn guard">
                        🛡️ 防御
                    </button>
                    <button id="item-btn" class="action-btn item">
                        🧪 アイテム
                    </button>
                </div>

                <!-- スキル選択パネル(ドラゴンクエスト風) -->
                <div id="skill-panel" class="action-panel hidden">
                    <div class="panel-header">
                        <h4>✨ スキル選択</h4>
                        <div class="current-mp">MP: <span id="skill-mp-display">--/--</span></div>
                    </div>
                    <div class="skill-grid vertical-menu">
                        <!-- スキルは動的に生成 -->
                    </div>
                    <button id="skill-back" class="back-btn">← 戻る</button>
                </div>

                <!-- アイテム選択パネル -->
                <div id="item-panel" class="action-panel hidden">
                    <h4>アイテム選択</h4>
                    <div class="item-grid">
                        <button class="item-option" data-item="potion">🧪 ポーション (HP+30)</button>
                        <button class="item-option" data-item="mana">💙 マナポーション (MP+20)</button>
                        <button class="item-option" data-item="bomb">💣 爆弾 (大ダメージ)</button>
                    </div>
                    <button id="item-back" class="back-btn">戻る</button>
                </div>
            </div>
        </main>

        <!-- ゲームオーバー・勝利画面 -->
        <div id="result-screen" class="screen hidden">
            <div id="result-content">
                <h2 id="result-title">勝利！</h2>
                <p id="result-message">見事な戦いでした！</p>
                <div id="result-rewards">
                    <p>獲得EXP: <span id="gained-exp">50</span></p>
                    <p>獲得ゴールド: <span id="gained-gold">100</span></p>
                </div>
                <button id="next-battle-btn" class="result-btn">次の戦闘</button>
                <button id="town-btn" class="result-btn">街に戻る</button>
            </div>
        </div>

        <!-- 街画面 -->
        <div id="town-screen" class="screen hidden">
            <div id="town-content">
                <h2>🏘️ 冒険者の街</h2>
                <p>ここで休息を取り、装備を整えて次の戦いに備えよう。</p>
                
                <div id="town-menu">
                    <button id="shop-btn" class="town-menu-btn">
                        🏪 ショップ
                        <span class="btn-description">アイテムを購入</span>
                    </button>
                    <button id="weapon-shop-btn" class="town-menu-btn">
                        🗡️ 武器屋
                        <span class="btn-description">武器を購入</span>
                    </button>
                    <button id="rest-btn" class="town-menu-btn">
                        🛏️ 宿屋 (20G)
                        <span class="btn-description">HP・MPを全回復</span>
                    </button>
                    <button id="battle-btn" class="town-menu-btn">
                        ⚔️ 冒険に出る
                        <span class="btn-description">戦闘を開始</span>
                    </button>
                    <button id="weapon-btn" class="town-menu-btn weapon-menu">
                        🔄 武器変更
                        <span class="btn-description">装備する武器を変更</span>
                    </button>
                    <button id="town-save-btn" class="town-menu-btn save-menu">
                        💾 セーブ
                        <span class="btn-description">ゲーム進行状況を保存</span>
                    </button>
                    <button id="help-btn" class="town-menu-btn help-menu">
                        ❓ システムガイド
                        <span class="btn-description">戦闘システムの詳細説明</span>
                    </button>
                </div>
                
                <div id="town-stats">
                    <p>💰 所持金: <span id="town-gold">0</span>G</p>
                    <p>📊 レベル: <span id="town-level">1</span> (EXP: <span id="town-exp">0</span>/<span id="town-exp-next">50</span>)</p>
                </div>
            </div>
        </div>

        <!-- 武器選択画面 -->
        <div id="weapon-screen" class="screen hidden">
            <div id="weapon-content">
                <h2>🗡️ 武器変更</h2>
                <p>装備する武器を選択してください。</p>
                
                <div id="current-weapon-info">
                    <h3>現在の装備</h3>
                    <div id="current-weapon-display"></div>
                </div>
                
                <div id="weapon-selection">
                    <div class="weapon-option" data-weapon="sword">
                        <div class="weapon-icon">⚔️</div>
                        <div class="weapon-details">
                            <h4>剣</h4>
                            <p class="weapon-type">斬撃・突き | 2ヒット</p>
                            <p class="weapon-desc">バランスの取れた武器</p>
                        </div>
                        <button class="equip-btn">装備</button>
                    </div>
                    
                    <div class="weapon-option" data-weapon="club">
                        <div class="weapon-icon">🏏</div>
                        <div class="weapon-details">
                            <h4>棍棒</h4>
                            <p class="weapon-type">打撃 | 3ヒット</p>
                            <p class="weapon-desc">連続攻撃が得意</p>
                        </div>
                        <button class="equip-btn">装備</button>
                    </div>
                    
                    <div class="weapon-option" data-weapon="axe">
                        <div class="weapon-icon">🪓</div>
                        <div class="weapon-details">
                            <h4>斧</h4>
                            <p class="weapon-type">打撃・斬撃 | 1ヒット</p>
                            <p class="weapon-desc">一撃が重い</p>
                        </div>
                        <button class="equip-btn">装備</button>
                    </div>
                </div>
                
                <button id="weapon-back" class="back-btn">街に戻る</button>
            </div>
        </div>

        <!-- ショップ画面 -->
        <div id="shop-screen" class="screen hidden">
            <div id="shop-content">
                <h2>🏪 アイテムショップ</h2>
                <p>冒険に必要なアイテムを取り揃えております！</p>
                
                <div id="shop-items">
                    <div class="shop-item">
                        <div class="item-info">
                            <span class="item-name">🧪 ポーション</span>
                            <span class="item-effect">HP +30</span>
                        </div>
                        <div class="item-price">50G</div>
                        <button class="buy-btn" data-item="potion" data-price="50">購入</button>
                    </div>
                    
                    <div class="shop-item">
                        <div class="item-info">
                            <span class="item-name">💙 マナポーション</span>
                            <span class="item-effect">MP +20</span>
                        </div>
                        <div class="item-price">75G</div>
                        <button class="buy-btn" data-item="mana" data-price="75">購入</button>
                    </div>
                    
                    <div class="shop-item">
                        <div class="item-info">
                            <span class="item-name">💣 爆弾</span>
                            <span class="item-effect">大ダメージ</span>
                        </div>
                        <div class="item-price">100G</div>
                        <button class="buy-btn" data-item="bomb" data-price="100">購入</button>
                    </div>
                </div>
                
                <div id="shop-inventory">
                    <h3>現在の所持品</h3>
                    <div id="inventory-list">
                        <span>🧪 ポーション: <span id="inv-potion">0</span>個</span>
                        <span>💙 マナポーション: <span id="inv-mana">0</span>個</span>
                        <span>💣 爆弾: <span id="inv-bomb">0</span>個</span>
                    </div>
                </div>
                
                <div id="shop-controls">
                    <div id="shop-gold">💰 所持金: <span id="shop-current-gold">0</span>G</div>
                    <button id="shop-back" class="back-btn">街に戻る</button>
                </div>
            </div>
        </div>

        <!-- 武器屋画面 -->
        <div id="weapon-shop-screen" class="screen hidden">
            <div id="weapon-shop-content">
                <h2>🗡️ 武器屋</h2>
                <p>強力な武器で冒険を有利に進めよう！</p>
                
                <div id="weapon-shop-items">
                    <div class="shop-item">
                        <div class="item-info">
                            <span class="item-name">⚔️ 鋼の剣</span>
                            <span class="item-effect">斬撃・突き | 2ヒット | 攻撃力 1.2倍</span>
                        </div>
                        <div class="item-price">200G</div>
                        <button class="buy-weapon-btn" data-weapon="steel_sword" data-price="200">購入</button>
                    </div>
                    
                    <div class="shop-item">
                        <div class="item-info">
                            <span class="item-name">🏏 鉄の棍棒</span>
                            <span class="item-effect">打撃 | 4ヒット | 攻撃力 1.1倍</span>
                        </div>
                        <div class="item-price">180G</div>
                        <button class="buy-weapon-btn" data-weapon="iron_club" data-price="180">購入</button>
                    </div>
                    
                    <div class="shop-item">
                        <div class="item-info">
                            <span class="item-name">🪓 戦斧</span>
                            <span class="item-effect">打撃・斬撃 | 1ヒット | 攻撃力 1.8倍</span>
                        </div>
                        <div class="item-price">300G</div>
                        <button class="buy-weapon-btn" data-weapon="battle_axe" data-price="300">購入</button>
                    </div>
                    
                    <div class="shop-item">
                        <div class="item-info">
                            <span class="item-name">✨ 聖剣</span>
                            <span class="item-effect">斬撃・聖 | 2ヒット | 攻撃力 1.4倍</span>
                        </div>
                        <div class="item-price">500G</div>
                        <button class="buy-weapon-btn" data-weapon="holy_sword" data-price="500">購入</button>
                    </div>
                </div>
                
                <div id="weapon-shop-inventory">
                    <h3>所有武器</h3>
                    <div id="weapon-inventory-list">
                        <!-- 動的に生成 -->
                    </div>
                </div>
                
                <div id="weapon-shop-controls">
                    <div id="weapon-shop-gold">💰 所持金: <span id="weapon-shop-current-gold">0</span>G</div>
                    <button id="weapon-shop-back" class="back-btn">街に戻る</button>
                </div>
            </div>
        </div>

        <!-- システムガイド画面 -->
        <div id="help-screen" class="screen hidden">
            <div id="help-content">
                <h2>⚔️ 戦闘システムガイド</h2>
                
                <div class="help-section">
                    <h3>🎯 コンボシステム</h3>
                    <div class="help-details">
                        <div class="help-item">
                            <strong>コンボの増加：</strong>
                            <ul>
                                <li>通常攻撃：+1</li>
                                <li>スキル攻撃：+2</li>
                            </ul>
                        </div>
                        <div class="help-item">
                            <strong>コンボの効果：</strong>
                            <ul>
                                <li>クリティカル率 = 15% + コンボ数×5%</li>
                                <li>最大コンボ5以上で戦闘終了時にボーナスゴールド（+20%）</li>
                                <li>コンボ数に応じて攻撃音が高くなる</li>
                            </ul>
                        </div>
                        <div class="help-item">
                            <strong>コンボのリセット：</strong>
                            <ul>
                                <li>敵の攻撃を受ける（防御していない場合）</li>
                                <li>新しい敵との戦闘開始時</li>
                            </ul>
                        </div>
                        <div class="help-item">
                            <strong>戦略のコツ：</strong>
                            <ul>
                                <li>🛡️防御でコンボを守りつつMP回復</li>
                                <li>⚡スキルで効率的なコンボ蓄積</li>
                                <li>高コンボ時は慎重に戦う</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="help-section">
                    <h3>🩸 傷口システム</h3>
                    <div class="help-details">
                        <div class="help-item">
                            <strong>弱点を突くと：</strong>
                            <ul>
                                <li>ダメージ1.5倍</li>
                                <li>該当する傷が蓄積（20%防御減少）</li>
                                <li>最大4回まで蓄積（80%減少上限）</li>
                            </ul>
                        </div>
                        <div class="help-item">
                            <strong>傷の種類：</strong>
                            <ul>
                                <li>物理傷：🩸斬撃、🟤打撃、🔴突き</li>
                                <li>魔法傷：🔥炎、⚡雷、✨聖、❄️氷</li>
                            </ul>
                        </div>
                        <div class="help-item">
                            <strong>累積効果：</strong>
                            <p>例：斬撃弱点に3回攻撃→ダメージが100→150→170→190と増加</p>
                        </div>
                    </div>
                </div>

                <div class="help-section">
                    <h3>⚔️ 武器システム</h3>
                    <div class="help-details">
                        <div class="help-item">
                            <strong>武器の特徴：</strong>
                            <ul>
                                <li>各武器は固有の攻撃タイプと属性を持つ</li>
                                <li>連続ヒット数と攻撃倍率が異なる</li>
                                <li>武器屋で上位武器を購入可能</li>
                            </ul>
                        </div>
                        <div class="help-item">
                            <strong>弱点の見極め：</strong>
                            <ul>
                                <li>スライム：🩸斬撃に弱い</li>
                                <li>ゴブリン：🟤打撃と🔥炎に弱い</li>
                                <li>オーク：🔴突きと⚡雷に弱い</li>
                                <li>ドラゴン：🟤打撃と🔴突きに弱い</li>
                                <li>デーモン：🩸斬撃と✨聖に弱い</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="help-controls">
                    <button id="help-back" class="back-btn">街に戻る</button>
                </div>
            </div>
        </div>
    </div>

    <script src="sound.js"></script>
    <script src="script.js"></script>
</body>
</html>