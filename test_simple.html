<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>🧪 シンプルサウンドテスト</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #222; color: white; }
        button { padding: 15px 30px; margin: 10px; border: none; border-radius: 5px; background: #4CAF50; color: white; cursor: pointer; font-size: 16px; }
        button:hover { background: #45a049; }
        #console { background: #111; padding: 15px; border-radius: 5px; height: 300px; overflow-y: auto; font-family: monospace; font-size: 12px; white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>🧪 シンプルサウンドテスト</h1>
    
    <div>
        <button onclick="testSimpleSound()">🎵 シンプル音再生</button>
        <button onclick="testMultipleSounds()">🎶 複数音再生</button>
        <button onclick="checkState()">📊 状態確認</button>
        <button onclick="clearConsole()">🧹 ログクリア</button>
    </div>
    
    <div id="console"></div>

    <script src="sound_simple.js"></script>
    <script>
        // コンソールログをページに表示
        const originalLog = console.log;
        const originalError = console.error;
        
        function addToConsole(message, type = 'log') {
            const consoleDiv = document.getElementById('console');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#ff4444' : type === 'warn' ? '#ffaa00' : '#ffffff';
            consoleDiv.innerHTML += `<span style="color: ${color}">[${timestamp}] ${message}</span>\n`;
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToConsole(args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToConsole(args.join(' '), 'error');
        };
        
        async function testSimpleSound() {
            console.log('🧪 シンプル音テスト開始...');
            if (window.simpleSoundManager) {
                await window.simpleSoundManager.playSound(440, 0.5);
            } else {
                console.error('❌ simpleSoundManagerが存在しません');
            }
        }
        
        async function testMultipleSounds() {
            console.log('🧪 複数音テスト開始...');
            if (window.simpleSoundManager) {
                const notes = [261, 294, 329, 349]; // C-D-E-F
                for (let i = 0; i < notes.length; i++) {
                    setTimeout(() => {
                        window.simpleSoundManager.playSound(notes[i], 0.3);
                    }, i * 200);
                }
            } else {
                console.error('❌ simpleSoundManagerが存在しません');
            }
        }
        
        function checkState() {
            console.log('📊 状態確認:');
            console.log('  - window.simpleSoundManager:', !!window.simpleSoundManager);
            if (window.simpleSoundManager) {
                console.log('  - isReady:', window.simpleSoundManager.isReady);
                console.log('  - audioContext:', !!window.simpleSoundManager.audioContext);
                if (window.simpleSoundManager.audioContext) {
                    console.log('  - audioContext.state:', window.simpleSoundManager.audioContext.state);
                }
            }
        }
        
        function clearConsole() {
            document.getElementById('console').innerHTML = '';
        }
        
        // 初期状態表示
        setTimeout(() => {
            console.log('🧪 シンプルテストページ読み込み完了');
            checkState();
        }, 100);
    </script>
</body>
</html>